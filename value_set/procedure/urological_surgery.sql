/*
 Recreate materialized view for urological_surgery procedure codes.
 value set oid: 2.16.840.1.113883.3.117.1.7.1.272
 url: https://vsac.nlm.nih.gov/valueset/2.16.840.1.113883.3.117.1.7.1.272/expansion/
 Code System: ICD-9-PCS
 Inclusion: Includes concepts that represent a procedure for urologic surgery.
 Exclusion: No exclusions.
 note: Because both the inclusion and exclusion criteria are empty, this value set includes codes from 2022 and 2012
 to capture more from the data.
 Used AHRQ (Agency for Healthcare Research and Quality) MapIT to convert ICD-10 to ICD-9 for supplemental value set.
 This is based on the general equivalency mappings (GEMs) from CMS. https://www.cms.gov/medicare/coding/icd10/downloads/icd-10_gem_fact_sheet.pdf
 versions: eCQM Update 2022-05-05 & MU2 Update 2012-10-25
 */
DROP MATERIALIZED VIEW IF EXISTS value_set.urological_surgery;
CREATE MATERIALIZED VIEW IF NOT EXISTS value_set.urological_surgery AS
SELECT DISTINCT icd9_code AS icd9_code
FROM mimiciii.d_icd_procedures
WHERE icd9_code IN ('59',
                    '445',
                    '527',
                    '539',
                    '543',
                    '544',
                    '554',
                    '576',
                    '603',
                    '604',
                    '605',
                    '674',
                    '688',
                    '689',
                    '704',
                    '758',
                    '843',
                    '3001',
                    '3342',
                    '3471',
                    '3472',
                    '3473',
                    '3479',
                    '3483',
                    '3985',
                    '3994',
                    '3998',
                    '4284',
                    '4439',
                    '4440',
                    '4441',
                    '4442',
                    '4449',
                    '4461',
                    '4462',
                    '4463',
                    '4468',
                    '4469',
                    '4499',
                    '4531',
                    '4533',
                    '4541',
                    '4550',
                    '4551',
                    '4552',
                    '4561',
                    '4562',
                    '4571',
                    '4576',
                    '4579',
                    '4602',
                    '4604',
                    '4640',
                    '4641',
                    '4642',
                    '4643',
                    '4650',
                    '4651',
                    '4652',
                    '4671',
                    '4672',
                    '4673',
                    '4674',
                    '4675',
                    '4676',
                    '4679',
                    '4693',
                    '4694',
                    '4699',
                    '4792',
                    '4840',
                    '4843',
                    '4849',
                    '4850',
                    '4852',
                    '4861',
                    '4862',
                    '4863',
                    '4864',
                    '4865',
                    '4869',
                    '4871',
                    '4872',
                    '4873',
                    '4879',
                    '4893',
                    '4899',
                    '5136',
                    '5191',
                    '5192',
                    '5193',
                    '5251',
                    '5343',
                    '5349',
                    '5351',
                    '5359',
                    '5461',
                    '5462',
                    '5463',
                    '5464',
                    '5471',
                    '5472',
                    '5473',
                    '5474',
                    '5475',
                    '5499',
                    '5501',
                    '5502',
                    '5503',
                    '5511',
                    '5531',
                    '5532',
                    '5533',
                    '5534',
                    '5535',
                    '5539',
                    '5551',
                    '5552',
                    '5553',
                    '5554',
                    '5581',
                    '5582',
                    '5583',
                    '5587',
                    '5589',
                    '5592',
                    '5599',
                    '5640',
                    '5642',
                    '5651',
                    '5652',
                    '5662',
                    '5671',
                    '5672',
                    '5673',
                    '5674',
                    '5675',
                    '5679',
                    '5682',
                    '5683',
                    '5684',
                    '5686',
                    '5699',
                    '5722',
                    '5759',
                    '5771',
                    '5779',
                    '5781',
                    '5782',
                    '5783',
                    '5784',
                    '5785',
                    '5786',
                    '5787',
                    '5788',
                    '5789',
                    '5793',
                    '5799',
                    '5831',
                    '5839',
                    '5841',
                    '5842',
                    '5843',
                    '5844',
                    '5847',
                    '5849',
                    '5892',
                    '5899',
                    '5900',
                    '5902',
                    '5909',
                    '5979',
                    '5991',
                    '5992',
                    '5999',
                    '6021',
                    '6029',
                    '6069',
                    '6073',
                    '6094',
                    '6498',
                    '6521',
                    '6551',
                    '6561',
                    '6591',
                    '6651',
                    '6731',
                    '6761',
                    '6762',
                    '6769',
                    '6839',
                    '6849',
                    '6869',
                    '6941',
                    '6942',
                    '6949',
                    '6999',
                    '7061',
                    '7062',
                    '7071',
                    '7072',
                    '7073',
                    '7074',
                    '7075',
                    '7079',
                    '7091',
                    '7171',
                    '7172',
                    '7550',
                    '7551',
                    '7552',
                    '7561',
                    '7562',
                    '7569',
                    '7710',
                    '8492',
                    '8493',
                    '8499',
                    '8625',
                    '8628',
                    '8659',
                    '8689',
                    '9625',
                    '9999'
    );