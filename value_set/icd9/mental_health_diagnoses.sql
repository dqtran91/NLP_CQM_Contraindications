/*
 Recreate materialized view for mental-health-diagnoses icd9 codes.
 value set oid: 2.16.840.1.113883.3.464.1003.105.12.1004
 url: https://vsac.nlm.nih.gov/valueset/2.16.840.1.113883.3.464.1003.105.12.1004/expansion/
 Inclusion: Includes concepts that represent a diagnosis for mental health disorders.
 Exclusion: No exclusions.
 note: Because both the inclusion and exclusion criteria are empty, this value set includes codes from 2022 and 2012
 to capture more from the data.
 Used AHRQ (Agency for Healthcare Research and Quality) MapIT to convert ICD-10 to ICD-9 for supplemental value set.
 This is based on the general equivalency mappings (GEMs) from CMS. https://www.cms.gov/medicare/coding/icd10/downloads/icd-10_gem_fact_sheet.pdf
 versions: eCQM Update 2022-05-05 & MU2 Update 2012-10-25
 */
DROP MATERIALIZED VIEW IF EXISTS value_set.mental_health_diagnoses;
CREATE MATERIALIZED VIEW value_set.mental_health_diagnoses AS
SELECT DISTINCT icd9_code
FROM mimiciii.d_icd_diagnoses
WHERE icd9_code IN ('311',
                    '316',
                    '2900',
                    '2903',
                    '2908',
                    '2909',
                    '2930',
                    '2931',
                    '2939',
                    '2940',
                    '2948',
                    '2949',
                    '2967',
                    '2970',
                    '2971',
                    '2972',
                    '2973',
                    '2978',
                    '2979',
                    '2980',
                    '2981',
                    '2982',
                    '2983',
                    '2984',
                    '2988',
                    '2989',
                    '3003',
                    '3004',
                    '3005',
                    '3006',
                    '3007',
                    '3009',
                    '3010',
                    '3013',
                    '3014',
                    '3016',
                    '3017',
                    '3019',
                    '3020',
                    '3021',
                    '3022',
                    '3023',
                    '3024',
                    '3026',
                    '3029',
                    '3060',
                    '3061',
                    '3062',
                    '3063',
                    '3064',
                    '3066',
                    '3067',
                    '3068',
                    '3069',
                    '3070',
                    '3071',
                    '3073',
                    '3076',
                    '3077',
                    '3079',
                    '3080',
                    '3081',
                    '3082',
                    '3083',
                    '3084',
                    '3089',
                    '3090',
                    '3091',
                    '3093',
                    '3094',
                    '3099',
                    '3100',
                    '3101',
                    '3102',
                    '3108',
                    '3109',
                    '3124',
                    '3129',
                    '3130',
                    '3131',
                    '3133',
                    '3139',
                    '3141',
                    '3142',
                    '3148',
                    '3149',
                    '3151',
                    '3152',
                    '3154',
                    '3155',
                    '3158',
                    '3159',
                    '29010',
                    '29011',
                    '29012',
                    '29013',
                    '29020',
                    '29021',
                    '29040',
                    '29041',
                    '29042',
                    '29043',
                    '29381',
                    '29382',
                    '29383',
                    '29384',
                    '29389',
                    '29410',
                    '29411',
                    '29420',
                    '29500',
                    '29501',
                    '29502',
                    '29503',
                    '29504',
                    '29505',
                    '29510',
                    '29511',
                    '29512',
                    '29513',
                    '29514',
                    '29515',
                    '29520',
                    '29521',
                    '29522',
                    '29523',
                    '29524',
                    '29525',
                    '29530',
                    '29531',
                    '29532',
                    '29533',
                    '29534',
                    '29535',
                    '29540',
                    '29541',
                    '29542',
                    '29543',
                    '29544',
                    '29545',
                    '29550',
                    '29551',
                    '29552',
                    '29553',
                    '29554',
                    '29555',
                    '29560',
                    '29561',
                    '29562',
                    '29563',
                    '29564',
                    '29565',
                    '29570',
                    '29571',
                    '29572',
                    '29573',
                    '29574',
                    '29575',
                    '29580',
                    '29581',
                    '29582',
                    '29583',
                    '29584',
                    '29585',
                    '29590',
                    '29591',
                    '29592',
                    '29593',
                    '29594',
                    '29595',
                    '29600',
                    '29601',
                    '29602',
                    '29603',
                    '29604',
                    '29605',
                    '29606',
                    '29610',
                    '29611',
                    '29612',
                    '29613',
                    '29614',
                    '29615',
                    '29616',
                    '29620',
                    '29621',
                    '29622',
                    '29623',
                    '29624',
                    '29625',
                    '29626',
                    '29630',
                    '29631',
                    '29632',
                    '29633',
                    '29634',
                    '29635',
                    '29636',
                    '29640',
                    '29641',
                    '29642',
                    '29643',
                    '29644',
                    '29645',
                    '29646',
                    '29650',
                    '29651',
                    '29652',
                    '29653',
                    '29654',
                    '29655',
                    '29656',
                    '29660',
                    '29661',
                    '29662',
                    '29663',
                    '29664',
                    '29665',
                    '29666',
                    '29680',
                    '29681',
                    '29682',
                    '29689',
                    '29690',
                    '29699',
                    '29900',
                    '29901',
                    '29910',
                    '29911',
                    '29980',
                    '29981',
                    '29990',
                    '29991',
                    '30000',
                    '30001',
                    '30002',
                    '30009',
                    '30010',
                    '30011',
                    '30012',
                    '30013',
                    '30014',
                    '30015',
                    '30016',
                    '30019',
                    '30020',
                    '30021',
                    '30022',
                    '30023',
                    '30029',
                    '30081',
                    '30082',
                    '30089',
                    '30110',
                    '30111',
                    '30112',
                    '30113',
                    '30120',
                    '30121',
                    '30122',
                    '30150',
                    '30151',
                    '30159',
                    '30181',
                    '30182',
                    '30183',
                    '30184',
                    '30189',
                    '30250',
                    '30251',
                    '30252',
                    '30253',
                    '30270',
                    '30271',
                    '30272',
                    '30273',
                    '30274',
                    '30275',
                    '30276',
                    '30279',
                    '30281',
                    '30282',
                    '30283',
                    '30284',
                    '30285',
                    '30289',
                    '30650',
                    '30651',
                    '30652',
                    '30653',
                    '30659',
                    '30720',
                    '30721',
                    '30722',
                    '30723',
                    '30740',
                    '30741',
                    '30742',
                    '30743',
                    '30744',
                    '30745',
                    '30746',
                    '30747',
                    '30748',
                    '30749',
                    '30750',
                    '30751',
                    '30752',
                    '30753',
                    '30754',
                    '30759',
                    '30780',
                    '30781',
                    '30789',
                    '30921',
                    '30922',
                    '30923',
                    '30924',
                    '30928',
                    '30929',
                    '30981',
                    '30982',
                    '30983',
                    '30989',
                    '31200',
                    '31201',
                    '31202',
                    '31203',
                    '31210',
                    '31211',
                    '31212',
                    '31213',
                    '31220',
                    '31221',
                    '31222',
                    '31223',
                    '31230',
                    '31231',
                    '31232',
                    '31233',
                    '31234',
                    '31235',
                    '31239',
                    '31281',
                    '31282',
                    '31289',
                    '31321',
                    '31322',
                    '31323',
                    '31381',
                    '31382',
                    '31383',
                    '31389',
                    '31400',
                    '31401',
                    '31500',
                    '31501',
                    '31502',
                    '31509',
                    '31531',
                    '31532',
                    '31534',
                    '31535',
                    '31539',
                    '79989',
                    'V400',
                    'V402',
                    'V4039',
                    'V409'
    );
